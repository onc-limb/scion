# clearサブコマンド実装TODO

## コマンド基本実装
- [ ] clearコマンドのハンドラー実装
- [ ] 引数パーサーの実装（ブランチ名の取得）
- [ ] フラグの実装
  - [ ] `--force`フラグ（強制削除）
  - [ ] `--all`フラグ（全worktree削除）
  - [ ] `--keep-branch`フラグ（ブランチ保持）
  - [ ] `--help`フラグ

## Worktree検索・検証
- [ ] `git worktree list`の実行と解析
  - [ ] worktree一覧の取得
  - [ ] 各worktreeの情報パース
- [ ] 指定worktreeの存在確認
- [ ] 現在作業中のworktree検出
- [ ] メインworktreeの除外処理

## 削除前チェック
- [ ] 未コミット変更の検出
  - [ ] `git status --porcelain`の実行
  - [ ] 変更ファイルの解析
- [ ] 現在のworktreeかどうかの確認
- [ ] 削除可能性の判定
- [ ] 警告メッセージの生成

## 単一Worktree削除
- [ ] `git worktree remove`コマンドの実行
  - [ ] 通常削除モード
  - [ ] 強制削除モード（--force）
- [ ] ディレクトリ削除処理
  - [ ] `wtree/<branch-name>`ディレクトリの削除
  - [ ] エラーハンドリング
- [ ] ブランチ削除処理
  - [ ] `--keep-branch`フラグのチェック
  - [ ] `git branch -d`の実行
  - [ ] 強制削除時は`git branch -D`

## 全Worktree削除機能
- [ ] 削除対象worktreeのリストアップ
  - [ ] メインworktreeの除外
  - [ ] 削除可能なworktreeのフィルタリング
- [ ] 確認プロンプトの実装
  - [ ] worktree一覧の表示
  - [ ] y/N の入力処理
  - [ ] `--force`時のプロンプトスキップ
- [ ] バッチ削除処理
  - [ ] 順次削除の実行
  - [ ] エラー時の続行/中断判定
  - [ ] 進行状況の表示

## ロギング機能
- [ ] 削除前の状態記録
  - [ ] worktreeパス
  - [ ] ブランチ名
  - [ ] 最終コミットハッシュ
- [ ] 削除操作のログ記録
- [ ] エラー時の詳細ログ

## ユーザーインターフェース
- [ ] 削除確認メッセージ
- [ ] 進行状況表示
  - [ ] 単一削除時
  - [ ] 複数削除時のプログレス
- [ ] 成功/失敗メッセージ
- [ ] カラー出力対応

## エラーハンドリング
- [ ] worktree不在エラー
- [ ] 現在作業中worktree削除エラー
- [ ] 未コミット変更エラー
- [ ] 権限不足エラー
- [ ] Gitコマンド実行エラー
- [ ] ディレクトリ削除失敗エラー

## 安全性機能
- [ ] 削除前バックアップ検討
- [ ] 復元可能性の警告表示
- [ ] 重要ブランチ保護機能（main, master等）
- [ ] ドライラン機能の検討

## テスト
- [ ] 単一worktree削除テスト
  - [ ] 通常削除
  - [ ] 強制削除
  - [ ] ブランチ保持削除
- [ ] 全worktree削除テスト
  - [ ] 確認プロンプトのテスト
  - [ ] 複数worktree削除の成功
- [ ] エラーケーステスト
  - [ ] 未コミット変更の検出
  - [ ] 現在worktreeの削除拒否
  - [ ] 不在worktreeエラー
- [ ] モックを使用したGitコマンドテスト